<mat-card
  class="p-4 md:p-6 rounded-2xl shadow-md border-0 bg-gradient-to-br from-white to-gray-50"
>
  <div class="flex items-center gap-2 mb-4">
    <h5 class="text-lg font-semibold text-gray-800">Search Purchase Orders</h5>
    <span
      class="ml-auto text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded-full"
    >
      {{ searchResults?.length }} found
    </span>
  </div>

  <div class="flex flex-col md:flex-row gap-3 items-start md:items-center">
    <mat-form-field appearance="fill" class="flex-1 w-full">
      <mat-label>Search by PO number or description</mat-label>
      <input
        matInput
        [(ngModel)]="searchTerm"
        (keyup.enter)="onSearch()"
        placeholder="e.g., PO-2024-001 or 'widget shipment'"
        #searchInput
      />
      <mat-icon matPrefix class="text-gray-400">search</mat-icon>
      <button
        mat-icon-button
        matSuffix
        *ngIf="searchTerm"
        (click)="clearSearch()"
        class="text-gray-400 hover:text-gray-600"
      >
        <mat-icon>close</mat-icon>
      </button>
      <mat-hint class="text-xs text-gray-500">
        Press Enter or click Search to find purchase orders
      </mat-hint>
    </mat-form-field>

    <button
      mat-raised-button
      color="primary"
      (click)="onSearch()"
      [disabled]="!searchTerm.trim()"
      class="w-full md:w-auto h-12 md:h-14 px-6 flex items-center gap-2 rounded-xl shadow-md hover:shadow-lg transition-shadow"
    >
      <mat-icon>search</mat-icon>
      <span class="font-medium">Search</span>
    </button>
  </div>

  <div class="flex flex-wrap gap-2 mt-4">
    <button
      mat-stroked-button
      size="small"
      (click)="setQuickSearch('PO')"
      class="text-xs"
    >
      <mat-icon class="text-sm">receipt</mat-icon>
      PO Numbers
    </button>
    <button
      mat-stroked-button
      size="small"
      (click)="setQuickSearch('urgent')"
      class="text-xs"
    >
      <mat-icon class="text-sm">priority_high</mat-icon>
      Urgent
    </button>
    <button
      mat-stroked-button
      size="small"
      (click)="clearSearch()"
      class="text-xs ml-auto"
    >
      <mat-icon class="text-sm">clear_all</mat-icon>
      Clear All
    </button>
  </div>

  <div
    *ngIf="searchResults?.length"
    @fadeIn
    class="mt-6 border border-gray-200 rounded-xl overflow-hidden shadow-sm"
  >
    <div
      class="bg-gradient-to-r from-gray-50 to-gray-100 px-4 py-3 border-b border-gray-200"
    >
      <div class="flex items-center justify-between">
        <div class="flex items-center gap-2">
          <mat-icon class="text-gray-600 text-sm">list</mat-icon>
          <span class="text-sm font-medium text-gray-700">Search Results</span>
        </div>
        <span class="text-xs text-gray-500 bg-white px-2 py-1 rounded-full">
          {{ searchResults?.length }}
          {{ searchResults?.length === 1 ? "result" : "results" }}
        </span>
      </div>
    </div>

    <div class="divide-y divide-gray-100 max-h-96 overflow-y-auto">
      <div
        *ngFor="let po of searchResults; let i = index"
        @staggerFade
        class="p-4 cursor-pointer hover:bg-blue-50/50 transition-colors duration-150 border-l-4 border-transparent hover:border-blue-500"
        (click)="selectPo(po)"
      >
        <div class="flex items-start justify-between">
          <div class="flex-1">
            <div class="flex items-center gap-2 mb-1">
              <span class="font-semibold text-gray-900">{{
                po.orderNumber
              }}</span>
              <span
                class="text-xs px-2 py-1 rounded-full"
                [ngClass]="{
                  'bg-green-100 text-green-700': po.status === 'active',
                  'bg-yellow-100 text-yellow-700': po.status === 'pending',
                  'bg-blue-100 text-blue-700': po.status === 'completed',
                  'bg-gray-100 text-gray-700': !po.status
                }"
              >
                {{ po.status || "active" | titlecase }}
              </span>
            </div>
            <p class="text-sm text-gray-600 line-clamp-2 mb-2">
              {{ po.description }}
            </p>
            <div class="flex items-center gap-4 text-xs text-gray-500">
              <span class="flex items-center gap-1">
                <mat-icon class="text-xs text-gray-400"
                  >calendar_today</mat-icon
                >
                {{ po.date | date : "MMM d, y" }}
              </span>
              <span class="flex items-center gap-1">
                <mat-icon class="text-xs text-gray-400">inventory_2</mat-icon>
                {{ po.products.length || 0 }} products
              </span>
              <span class="flex items-center gap-1">
                <mat-icon class="text-xs text-gray-400">pallet</mat-icon>
                {{ po.totalItems || "N/A" }} items
              </span>
            </div>
          </div>
          <mat-icon class="text-gray-400 ml-2">chevron_right</mat-icon>
        </div>
      </div>
    </div>

    <div class="bg-gray-50 px-4 py-2 border-t border-gray-200">
      <div class="flex items-center justify-between text-xs text-gray-500">
        <span>Click any result to select</span>
        <button
          mat-button
          size="small"
          (click)="clearResults()"
          class="text-blue-600 hover:text-blue-800"
        >
          Clear Results
        </button>
      </div>
    </div>
  </div>

  <div *ngIf="isLoading" class="mt-6">
    <div class="flex items-center justify-center gap-3 text-gray-600">
      <mat-spinner diameter="20"></mat-spinner>
      <span>Searching purchase orders...</span>
    </div>
  </div>

  <div
    *ngIf="searchTerm && !searchResults?.length && !isLoading"
    @fadeIn
    class="mt-6 p-6 text-center border border-gray-200 rounded-xl bg-gray-50"
  >
    <mat-icon class="text-gray-400 text-4xl mb-3">search_off</mat-icon>
    <h4 class="text-lg font-medium text-gray-700 mb-2">No results found</h4>
    <p class="text-gray-500 mb-4">
      No purchase orders found for "{{ searchTerm }}". Try a different search
      term.
    </p>
    <button
      mat-stroked-button
      color="primary"
      (click)="clearSearch()"
      class="flex items-center gap-2 mx-auto"
    >
      <mat-icon>refresh</mat-icon>
      Clear Search
    </button>
  </div>
</mat-card>
